# 浅谈数据链路层05之介质访问子层
* 阅读难度 低

## 前言
* 网络链路可以分成两大类:使用点到点连接和使用广播信道。我们前面介绍了点到点链路，那么现在我们就来讨论一下广播网络和相应的协议

***

## 信道分配问题
* 我们先来谈一下静态分配方案

#### 静态信道分配
* 在多个竞争用户之间分配单个信道的传统做法是把信道容量拆分给多个用户使用。假设有N个用户，则整个宽带被分成N等份，每个用户都有自己专用的频段，所以用户之间不会发生干扰。这似乎很公平嘛，给每个用户平分信道容量，但是，当发送方的数量非常多，且不断变化的时候，或者流量出现突发性的时候，问题就来了。整个频段被分成N份，但是当前之后很少的用户(比N少得多)需要通信，但是流量又很大的时候，却只能拿到平分的容量。又或者是希望通信的用户数超过了N，则有些用户因宽带不够而被拒绝

* 所以，显而易见，我们需要动态信道分配的方案

#### 动态信道分配
* 在真正讨论动态信道分配方案的时候，我们有必要来谈一下5个关键假设，所有的方案都是以这几个假设为基础的
	1. 流量独立(independent traffic)。该模型是由N个独立的站点(比如计算机，电话)组成的，每个站点都有一个程序或者用户产生要传输的帧。一旦生成一帧，该站就会被阻塞，直到该帧被成功发出去
	2. 单信道(Single Channel).所有的信道都用这一个信道。所有的站可以在该信道上面传输数据，也可以从该信道接收数据。所有站的能力都相同，尽管站的能力都相同，尽管协议可能为站分配不同的角色(比如优先级)
	3. 冲突可观察(observable Collision)。如果两帧同时传输则它们在时间上就重叠了，由此产生的信号是混乱的。这种情况就叫做冲突。所有的站点都能检测冲突事件的发生。冲突的帧必须以后再次被发送
	4. 时间连续或分槽(Continuous or slotted time)。时间科技假设是连续，即在任何时刻都可以开始传输帧。另外一种选择是把时间分槽或者分成离散的时间间隔(称为时间槽)。帧的传输只能从某个时间槽的起始点开始。一个时间槽分别可能包含01或者多个帧，分别对应于空闲的时间槽，一次发送成功，或者一次冲突
	5.载波侦听或不听(Carrier Sense or no carrier sense)。有了载波侦听的假设，一个站在视图用信道之前就能知道该信道是否被使用。如果信道侦听结果是忙，则每用一个站会再去试图使用该信道。

***
### 多路访问协议
* 那么我们现在就来看一下，动态信道分配的算法

#### ALOHA
* 我们要在这里讨论两个版本的ALOHA：纯ALOHA和分槽的ALOHA。它们的区别在于时间是连续的，那就是纯粹的ALOHA；或者时间被分成离散槽，所有帧都必须同步到时间槽

##### 纯ALOHA
* ALOHA系统的基本思想非常简单:当用户有数据需要发送的时候就发送。当然，这样做是有很大可能产生冲突的，冲突的帧将被破坏。发送方需要某种途径来发现是否发生了冲突。在ALOHA系统中，每个站在给中央计算机发送帧以后，该计算机把该帧重新广播给所有的站。因此，那个发送站通过侦听来自集线器的广播，以此确定是否发送成功。在其他系统中，比如有线局域网中，发送方发送的同时能侦听到冲突的发生

* 如果帧被损坏了，则发送方要等待一段随机时间，然后再次发送该帧。等待的时间必须是随机的，否则同样的帧会一次又一次地冲突，因为冲突帧被重发的节奏完全一致。如果系统中多个用户共享一个信道的方法出现冲突，则这样的系统称为竞争

![](https://github.com/SeaHub/BlogOfComputerNetwork/blob/master/res/aloha.png)

* 无论何时，只要两个帧在相同时间试图占用信道，冲突就会发生(如图)，并且两帧都会被破坏。如果新帧的第一位与几乎快传完的上一帧的最后以为重叠，则两帧都会被彻底破坏(不正确的校验和)，稍后都会被重传。检验和不可能(也不应该)区分出是完全损坏还是局部差错。坏了就是坏了

* 那么，来谈一下我们最关心的问题，纯ALOHA的效率怎么样呢。经过计算，该系统最好的信道利用率也只有18%.这个真的很难令人满意

### 结语
正是因为纯ALOHA的不尽人意，所以有了分槽ALOHA，更多相关的讨论，我们下次再聊

---
* 文章更新时间：2016.5.26
* 作者：Samray
